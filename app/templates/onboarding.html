<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>SmartCoop - Cooperative Society Management App</title>
    <link
      rel="shortcut icon"
      href="{{ url_for('static', filename='logo1.png') }}"
      type="image/x-icon"
    />
    <!-- Bootstrap , fonts & icons  -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/bootstrap.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='fonts/icon-font/css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='fonts/typography-font/typo.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='fonts/fontawesome-5/css/all.css') }}"
    />
    <!-- Plugin stylesheets  -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='plugins/aos/aos.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='plugins/fancybox/jquery.fancybox.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='plugins/nice-select/nice-select.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='plugins/slick/slick.min.css') }}"
    />
    <!-- Vendor stylesheets  -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='plugins/theme-mode-switcher/switcher-panel.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/main.css') }}"
    />
    <!-- Toastify stylesheets -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <script>
      const currentURL = window.location.origin;
    </script>
  </head>
  <body data-theme-mode-panel-active data-theme="light">
    <div class="site-wrapper overflow-hidden">
      <div id="loading">
        <img src="{{ url_for('static', filename='logo1.png') }}" alt="" />
      </div>
      <!-- Sign-Up Form -->
      <div class="form-block form-block--sign-up bg-default-3">
        <div class="container">
          <div class="row align-items-center justify-content-center">
            <div
              class="col-xxl-5 col-xl-6 col-lg-7 col-md-8 col-xs-10 scrollable-form"
            >
              <div
                class="form-img position-absolute bg-image"
                style="background-image: url({{ url_for('static', filename='image/emoji.avif') }})"
              ></div>
            </div>
            <div class="col-xxl-5 col-xl-6 col-lg-7 col-md-8 col-xs-10">
              <div class="section-title section-title--l5 pb-6">
                <h2
                  class="section-title__heading"
                  data-aos="fade-up"
                  data-aos-duration="500"
                  data-aos-once="true"
                >
                  Sign Up to SmartCoop
                </h2>
                <p
                  class="section-title__description"
                  data-aos="fade-up"
                  data-aos-duration="500"
                  data-aos-delay="300"
                  data-aos-once="true"
                >
                  Complete the form to create your account
                </p>
              </div>
              <div
                class="form-box form-box--sign-up"
                data-aos="fade-up"
                data-aos-duration="500"
                data-aos-delay="500"
                data-aos-once="true"
              >
                <div
                  class="contact-form"
                  data-aos="fade-up"
                  data-aos-duration="500"
                  data-aos-delay="300"
                  data-aos-once="true"
                >
                  <form id="signup-form">
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Full Name"
                        id="fullname"
                        required
                      />
                      <label for="fullname">Full Name</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="email"
                        placeholder="Email"
                        id="email"
                        required
                      />
                      <label for="email">Email</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="password"
                        placeholder="password"
                        id="password"
                        required
                      />
                      <label for="email">Password</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="password"
                        placeholder="password"
                        id="password2"
                        required
                      />
                      <label for="email">Confirm Password</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Phone Number"
                        id="phoneno"
                        required
                      />
                      <label for="phoneno">Phone Number</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Address"
                        id="address"
                        required
                      />
                      <label for="address">Address</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Staff ID"
                        id="staff_id"
                        required
                      />
                      <label for="staff_id">Staff ID</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="date"
                        placeholder="Date of Birth"
                        id="dob"
                        required
                      />
                      <label for="dob">Date of Birth</label>
                    </div>
                    <div>
                      <select id="gender" required>
                        <option value="s" disabled selected>
                          Select Gender
                        </option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                      </select>
                      <label for="gender">Gender</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Cooperative ID"
                        id="cooperative_id"
                        required
                      />
                      <label for="cooperative_id">Cooperative ID</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Next of Kin Name"
                        id="nok_name"
                      />
                      <label for="nok_name">Next of Kin Name</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Next of Kin Phone"
                        id="nok_phone"
                      />
                      <label for="nok_phone">Next of Kin Phone</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Next of Kin Relationship"
                        id="nok_relationship"
                      />
                      <label for="nok_relationship"
                        >Next of Kin Relationship</label
                      >
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Bank Name"
                        id="bank_name"
                      />
                      <label for="bank_name">Bank Name</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Account Number"
                        id="account_number"
                      />
                      <label for="account_number">Account Number</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Sort Code"
                        id="sort_code"
                      />
                      <label for="sort_code">Sort Code</label>
                    </div>
                    <div class="form-floating">
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Salary Number"
                        id="salary_number"
                      />
                      <label for="salary_number">Salary Number</label>
                    </div>
                    <button
                      class="btn btn-primary shadow--primary-5 btn--lg-2 rounded-55 text-white mt-2"
                      type="submit"
                    >
                      Create Member
                    </button>
                  </form>
                </div>
                <p class="ms-2">
                  Already a member?
                  <a
                    class="btn-link--2 text-electric-violet-2 ms-2"
                    href="/sign-in-member"
                    >Sign In</a
                  >
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Plugin's Scripts -->
    <script src="{{ url_for('static', filename='plugins/jquery/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/jquery/jquery-migrate.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/fancybox/jquery.fancybox.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/nice-select/jquery.nice-select.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/aos/aos.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/counter-up/jquery.counterup.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/counter-up/waypoints.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/slick/slick.min.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/skill-bar/skill.bars.jquery.js') }}"></script>
    <script src="{{ url_for('static', filename='plugins/isotope/isotope.pkgd.min.js') }}"></script>
    <!-- Activation Script -->
    <script src="{{ url_for('static', filename='js/menu.js') }}"></script>
    <script src="{{ url_for('static', filename='js/custom.js') }}"></script>
    <!-- Toastify script -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script>
      document
        .getElementById("signup-form")
        .addEventListener("submit", async function (event) {
          event.preventDefault();
          // alert("ssss");
          const fullname = document.getElementById("fullname").value;
          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;
          const password2 = document.getElementById("password2").value;
          const phoneno = document.getElementById("phoneno").value;
          const address = document.getElementById("address").value;
          const staff_id = document.getElementById("staff_id").value;
          const dob = document.getElementById("dob").value;
          const gender = document.getElementById("gender").value;
          const cooperative_id =
            document.getElementById("cooperative_id").value;
          const nok_name = document.getElementById("nok_name").value;
          const nok_phone = document.getElementById("nok_phone").value;
          const nok_relationship =
            document.getElementById("nok_relationship").value;
          const bank_name = document.getElementById("bank_name").value;
          const account_number =
            document.getElementById("account_number").value;
          const sort_code = document.getElementById("sort_code").value;
          const salary_number = document.getElementById("salary_number").value;

          const data = {
            fullname,
            email,
            phoneno,
            address,
            staff_id,
            dob,
            gender,
            cooperative_id,
            nok_name,
            nok_phone,
            nok_relationship,
            bank_name,
            account_number,
            sort_code,
            salary_number,
            password,
          };
          if (password != password2) {
            Toastify({
              text: "Password do not match",
              backgroundColor: "linear-gradient(to right, #FF5F6D, #FFC371)",
              duration: 3000,
            }).showToast();
          } else {
            try {
              const response = await fetch(
                `${currentURL}/cooperative/members/create`,
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                  },
                  body: JSON.stringify(data),
                }
              );

              if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
              }

              const result = await response.json();
              Toastify({
                text: "Member created successfully! Please Login",
                backgroundColor: "linear-gradient(to right, #00b09b, #96c93d)",
                duration: 3000,
              }).showToast();

              setTimeout(() => {
                window.location.href = "/sign-in-member";
              }, 3000);
            } catch (error) {
              console.error("Error:", error);
              Toastify({
                text: "An error occurred. Please try again later.",
                backgroundColor: "linear-gradient(to right, #FF5F6D, #FFC371)",
                duration: 3000,
              }).showToast();
            }
          }
        });
    </script>
  </body>
</html>
